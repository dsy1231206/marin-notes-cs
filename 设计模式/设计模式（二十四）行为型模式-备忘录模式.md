# 设计模式（二十四）行为型模式-备忘录模式

###### 备忘录模式又叫快照模式，在不破坏封装性的前提下，捕捉一个对象的内部状态，并在该对象之外保存这个状态，以便以后需要时能恢复到原先保存的状态

##### 结构

发起人：记录当前时刻的内部状态信息，提供创建备忘录和恢复备忘录数据的功能，实现其他业务功能，它可以访问备忘录里所有信息

备忘录角色：负责存储发起人的内部状态

管理者角色：对备忘录进行管理，提供保存于获取备忘录的功能，但不能对备忘录进行修改

###### 备忘录有两个等效的接口：

###### 	窄接口：管理者对象看到的都是备忘录的窄接口，这个窄接口允许他把备忘录对象传给其他对象

###### 	宽接口：发起人对象可以看到一个宽接口，允许他读取所有的数据



##### 白箱备忘录模式

备忘录角色对任何对象都提供一个接口，即宽接口，这样的话，备忘录角色的内部存储状态就对所有对象公开

![image-20220628102112944](C:\Users\HP\AppData\Roaming\Typora\typora-user-images\image-20220628102112944.png)

使用一个备忘录对象来保存目标对象的状态，并在目标对象中提供保存和恢复状态的方法

![image-20220628102234613](C:\Users\HP\AppData\Roaming\Typora\typora-user-images\image-20220628102234613.png)

但白箱模式也有一个问题，就是程序写好之后别的人也能调用备忘录角色，访问到里面的数据，这就破坏掉了程序的封装性。

##### 黑箱备忘录模式

备忘录角色对发起人对象提供一个宽接口，而为其他对象提供窄接口

相对于白箱模式，就是要将RoleStateMemento设为GameRole的私有成员内部类，这样外界就不能直接访问了

![image-20220628104008861](C:\Users\HP\AppData\Roaming\Typora\typora-user-images\image-20220628104008861.png)

![image-20220628104051070](C:\Users\HP\AppData\Roaming\Typora\typora-user-images\image-20220628104051070.png)

###### 黑箱备忘录模式的核心就是要把备忘录角色类定义在发起人角色类的内部，并且将其私有，外界就不能进行访问了。